{% extends "navbar.html" %}


{% macro commenttree(comments) -%}
  {%- for comment in comments -%}

    <div class="media">
      <a class="pull-left" href="#">
	<img class="media-object" src="" alt="{{ comment[-1] }}">
      </a>
      <div class="media-body">
	<div class="jumbotron">
	  <h3 class="media-heading">{{ comment[-1] }}</h3>
	  <p>
	    {%- for line in comment[2] -%}
              {{ line }}
              {%- if not loop.last -%}
                <br />
              {%- endif -%}
	    {%- endfor -%}
	  <p/>
	  {% if current_user.is_authenticated() %}
            <p><a class="btn btn-primary btn-md" role="button" href="/post?comment={{ comment[0] }}">Post Reply</a></p>
	  {% endif %}
	</div>

	{%- if comment[5] != [] -%}
          {{ commenttree(comment[5]) }} 
	{% endif %}
      </div>
    </div>
  {%- endfor -%}
{%- endmacro %}
  
{% block body %}
  {% if groups %}
  <ul class="list-group">
    {%- for group in groups -%} 
      <li class="list-group-item">
	<span class="badge">{{ group[2] }}</span>
	<a href="?topic={{ group[0] }}">{{ group[1] }}</a>
      </li>
    {%- endfor -%}
  </ul>
  {% endif %}
  {% if comments %}
    {{ commenttree(comments) }}
    <p><a class="btn btn-primary btn-md" role="button" href="/post?topic={{group}}">New Post</a></p>
  {% endif %}
{% endblock %}
